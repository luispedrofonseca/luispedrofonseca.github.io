<!DOCTYPE html>
<html lang="en-us">
<head>
    <title>Unity VR Joystick &middot; Luís Pedro Fonseca</title>
    <meta name="generator" content="Hugo 0.17" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="Luís Pedro Fonseca">
    
      <meta name="description" content="Freelance Unity Game Developer">
    
    
    <link rel="icon" href="http://www.luispedrofonseca.com/favicon.ico">
    <link rel="apple-touch-icon" href="http://www.luispedrofonseca.com/apple-touch-icon.png" />
    <link rel="stylesheet" href="http://www.luispedrofonseca.com/css/style.css">
    <link rel="stylesheet" href="http://www.luispedrofonseca.com/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://www.luispedrofonseca.com/css/monokai.css">
    <link rel="stylesheet" href="http://www.luispedrofonseca.com/fancybox/jquery.fancybox.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
    <meta property="og:title" content="Unity VR Joystick" />
<meta property="og:description" content="For the past year I&rsquo;ve become more and more interested in virtual reality, especially after trying out a bunch of demos at the last Unite in LA. So much, that I&rsquo;ve decided to go ahead a buy an HTC Vive. Being a new technology, it&rsquo;s still quite expensive, not only for the device itself but also because you need to have quite a beefy PC to support it. So I&rsquo;ve put together an Hackintosh (more about that in a future post), so I can still use OSX for my daily job but also run Windows which is a requirement for desktop VR." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.luispedrofonseca.com/unity-vr-joystick/" />


<meta property="og:updated_time" content="2017-02-02T00:00:00&#43;00:00"/>










    
    
<meta itemprop="name" content="Unity VR Joystick">
<meta itemprop="description" content="For the past year I&rsquo;ve become more and more interested in virtual reality, especially after trying out a bunch of demos at the last Unite in LA. So much, that I&rsquo;ve decided to go ahead a buy an HTC Vive. Being a new technology, it&rsquo;s still quite expensive, not only for the device itself but also because you need to have quite a beefy PC to support it. So I&rsquo;ve put together an Hackintosh (more about that in a future post), so I can still use OSX for my daily job but also run Windows which is a requirement for desktop VR.">


<meta itemprop="dateModified" content="2017-02-02T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="563">



<meta itemprop="keywords" content="csharp,plugins,procamera2d,project-cuba,uncategorized,unity," />

    

  <meta name="twitter:card" content="summary"/>



<meta name="twitter:title" content="Unity VR Joystick"/>
<meta name="twitter:description" content="For the past year I&rsquo;ve become more and more interested in virtual reality, especially after trying out a bunch of demos at the last Unite in LA. So much, that I&rsquo;ve decided to go ahead a buy an HTC Vive. Being a new technology, it&rsquo;s still quite expensive, not only for the device itself but also because you need to have quite a beefy PC to support it. So I&rsquo;ve put together an Hackintosh (more about that in a future post), so I can still use OSX for my daily job but also run Windows which is a requirement for desktop VR."/>
<meta name="twitter:site" content="@lpfonseca"/>


    

    
</head>
<body>
<div class="container">


<div id="container">
	<header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="http://www.luispedrofonseca.com/" id="logo">
        
        <span class="site-title">Luís Pedro Fonseca</span>
      </a>
      <nav id="main-nav">
          
          
          <a class="main-nav-link" href="http://www.luispedrofonseca.com/">Blog</a>
          
          
          
          <a class="main-nav-link" href="http://www.luispedrofonseca.com/about">About</a>
          
          
          
          <a class="main-nav-link" href="http://www.luispedrofonseca.com/contact">Contact</a>
          
          

          

          
          
          
          
          
          
          
      </nav>
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="http://www.luispedrofonseca.com/avatar.png"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
              <input type="search" name="q" results="0" class="search-form-input" placeholder="Search">
              <button type="submit" class="search-form-submit">
              </button>
              <input type="hidden" name="q" value="site:http://www.luispedrofonseca.com/">
         </form>
        </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tbody>
          <tr>
          
          
          <td><a class="main-nav-link" href="http://www.luispedrofonseca.com/">Blog</a></td>
          
          
          
          <td><a class="main-nav-link" href="http://www.luispedrofonseca.com/about">About</a></td>
          
          
          
          <td><a class="main-nav-link" href="http://www.luispedrofonseca.com/contact">Contact</a></td>
          
          

          

          
          
          
          
          
          
          
          <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
          <input type="search" name="q" results="0" class="search-form-input" placeholder="Search">
          <input type="hidden" name="q" value="site:http://www.luispedrofonseca.com/">
          </form>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</header>

   	
   	<div class="outer">
   		
	    <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <img id="avatar" src="http://www.luispedrofonseca.com/avatar.png">
      <h2 id="name">Luís Pedro Fonseca</h2>
      <h3 id="title">Senior developer @<a href="http://www.x-team.com">X-Team</a><br>Part-time indie game developer<br><a href="http://www.procamera2d.com">ProCamera2D</a> plugin author</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Porto, Portugal</span>
      
    </div>
    
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
          
















































<td><a href="//twitter.com/lpfonseca" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>


          <td><a href="" target="_blank" title="RSS"><i class="fa fa-rss"></i></a></td>
        </tr>
      </table>
    </div>
    <div></div>
  </div>
</aside>

	    

	    
<section id="main">

    <article id="page-undefined" class="article article-type-page" itemscope="" itemprop="blogPost">
        <div class="article-inner">
            
                
                <img src="http://www.luispedrofonseca.com/banners/unity-vr-joystick.png" class="article-banner">
                
            

            <header class="article-header">
    <a href="http://www.luispedrofonseca.com/unity-vr-joystick/">
    <h1 class="article-title" itemprop="name">
        Unity VR Joystick
    </h1>
    </a>
    <div class="article-meta">
        <div class="article-date">
            <i class="fa fa-calendar"></i>
            <time datetime="2017-02-02 00:00:00 &#43;0000 UTC" itemprop="datePublished">2017-02-02</time>
            
        </div>

        
        
            
            
            <div class="article-category">
                <i class="fa fa-folder"></i>
                
                <a class="article-category-link" href="http://www.luispedrofonseca.com/categories/unity">Unity</a>
                &middot;
                
                <a class="article-category-link" href="http://www.luispedrofonseca.com/categories/csharp">CSharp</a>
                
                
            </div>
            
        

        
    </div>
</header>

            <div class="article-entry" itemprop="articleBody">
                <p>For the past year I&rsquo;ve become more and more interested in virtual reality, especially after trying out a bunch of demos at the last Unite in LA. So much, that I&rsquo;ve decided to go ahead a buy an <a href="http://www.vive.com" target="_blank">HTC Vive</a>. Being a new technology, it&rsquo;s still quite expensive, not only for the device itself but also because you need to have quite a beefy PC to support it. So I&rsquo;ve put together an <a href="https://www.tonymacx86.com" target="_blank">Hackintosh</a> (more about that in a future post), so I can still use OSX for my daily job but also run Windows which is a requirement for desktop VR.</p>

<p>To put the Vive to good use I&rsquo;ve decided to create a simple flying game. The first challenge I faced was how could we control a plane using only the Vive controllers? The solution that made most sense to me was to recreate an airplane joystick (aka HOTAS), inside the game itself and then let the player grab it and move it using its own hands like in real life.</p>

<p>This is how it looks:</p>

<p><img src="http://www.luispedrofonseca.com/images/unity-vr-joystick/unity-vr-joystick.png" alt="" /></p>

<p>To speed up the development I&rsquo;ve been using the amazing <a href="https://github.com/thestonefox/VRTK" target="_blank">VRTK library</a> which is a collection of useful scripts and concepts to aid building VR solutions rapidly. It handles stuff like locomotion, interactions, physics, UI, etc. If you&rsquo;re planning to develop in VR using Unity, trust me, you&rsquo;ll want to use this library. Best of all, it&rsquo;s free and open-source!</p>

<p>Using VRTK made things really simple and all I had to do was to create a configurable joint between the stick and the base. Here are the settings I used:</p>

<p><img src="http://www.luispedrofonseca.com/images/unity-vr-joystick/unity-vr-joystick-configurable-joint.png" alt="" /></p>

<p>After creating the configurable joint, you&rsquo;ll need to create a new class that overrides the VRTK_InteractableObject class (from the VRTK library I mentioned earlier). This class gives all you need to know when the player grabbed, dropped or moved the joystick. With this in place you now have all the data needed to maneuver the plane, including the roll and pitch (mapped to XPercentage and ZPercentage here):</p>

<pre><code class="language-c">using System;
using System.Collections;
using UnityEngine;
using VRTK;

public class VRJoystick : VRTK_InteractableObject
{
    public Action OnUseStarted;
    public Action OnUseStopped;

    [Header(&quot;Joystick&quot;)]
    [SerializeField]
    Transform _handle;

    [SerializeField]
    float _maxXAngle = 45;

    [SerializeField]
    float _maxZAngle = 45;

    [SerializeField]
    [Range(0, 1)]
    float _vibrationStrenght = .1f;

    [SerializeField]
    [Range(0, 1)]
    float _vibrationInterval = .05f;

    public float XPercentage;
    public float ZPercentage;

    VRTK_ControllerActions _controllerActions;

    bool _grabbing;
    
    override protected void Update ()
    {
        base.Update();

        var angleX = _handle.localRotation.eulerAngles.x;
        if (angleX &gt; 180)
            angleX -= 360;

        var angleZ = _handle.localRotation.eulerAngles.z;
        if (angleZ &gt; 180)
            angleZ -= 360;

        XPercentage = angleX / _maxXAngle;
        ZPercentage = angleZ / _maxZAngle;
    }

    public override void StartTouching(GameObject currentTouchingObject)
    {
        base.StartTouching(currentTouchingObject);
        _controllerActions = currentTouchingObject.GetComponent&lt;VRTK_ControllerActions&gt;();
        Vibrate(.5f);
    }

    public override void StopTouching(GameObject previousTouchingObject)
    {
        base.StopTouching(previousTouchingObject);
        _controllerActions = previousTouchingObject.GetComponent&lt;VRTK_ControllerActions&gt;();
        Vibrate(.5f);
    }
    
    override public void Grabbed(GameObject grabbingObject)
    {
        base.Grabbed(grabbingObject);
        _controllerActions = grabbingObject.GetComponent&lt;VRTK_ControllerActions&gt;();
        Vibrate(.5f);
        _grabbing = true;

        StartCoroutine(DetectJoystickMovement());
    }

    override public void Ungrabbed(GameObject previousGrabbingObject)
    {
        base.Ungrabbed(previousGrabbingObject);

        _grabbing = false;
    }

    IEnumerator DetectJoystickMovement()
    {
        var currentXPercentage = XPercentage;
        var currentZPercentage = ZPercentage;
        while (_grabbing)
        {
            if(Mathf.Abs(currentXPercentage - XPercentage) &gt; _vibrationInterval)
            {
                Vibrate(_vibrationStrenght);
                currentXPercentage = XPercentage;
            }
            else if (Mathf.Abs(currentZPercentage - ZPercentage) &gt; _vibrationInterval)
            {
                Vibrate(_vibrationStrenght);
                currentZPercentage = ZPercentage;
            }

            yield return null;
        }
    }

    public override void StartUsing(GameObject currentUsingObject)
    {
        base.StartUsing(currentUsingObject);

        if (OnUseStarted != null)
            OnUseStarted();
    }

    public override void StopUsing(GameObject previousUsingObject)
    {
        base.StopUsing(previousUsingObject);

        if (OnUseStopped != null)
            OnUseStopped();
    }

    public void Vibrate(float vibrationStrength)
    {
        if(_controllerActions != null)
            _controllerActions.TriggerHapticPulse(vibrationStrength);
    }
}
</code></pre>

            </div>
            <footer class="article-footer">
    <a data-url="http://www.luispedrofonseca.com/unity-vr-joystick/" data-id="5a7f722efa1e9307347cfd3f899ba631" class="article-share-link">
        Share
    </a>
    
    <a href="http://www.luispedrofonseca.com/unity-vr-joystick//#disqus_thread" class="article-comment-link">
        Comments
    </a>
    
</footer>

        </div>

        
<nav id="article-nav">
    
    <a href="http://www.luispedrofonseca.com/unite-los-angeles-16/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">
          Older
      </strong>
      <div class="article-nav-title">Unite Los Angeles 16</div>
    </a>
    

    
</nav>


    </article>

    
    <section id="comments">
        <div id="disqus_thread">
            <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'luspedrofonseca';
    var disqus_identifier = 'http:\/\/www.luispedrofonseca.com\/unity-vr-joystick\/';
    var disqus_title = 'Unity VR Joystick';
    var disqus_url = 'http:\/\/www.luispedrofonseca.com\/unity-vr-joystick\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
    </section>
    
</section>


	    
	    <aside id="sidebar">
    
<div class="widget-wrap">
    <h3 class="widget-title">
        Latest Posts
    </h3>
    <div class="widget">
        <ul id="recent-post">
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://www.luispedrofonseca.com/unity-vr-joystick/" class="thumbnail">
                    
                        
                        <span style="background-image:url(http://www.luispedrofonseca.com/banners/unity-vr-joystick.png)" alt="Unity VR Joystick" class="thumbnail-image"></span>
                        
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-title"><a href="http://www.luispedrofonseca.com/unity-vr-joystick/" class="title">Unity VR Joystick</a></p>
                    <p class="item-date">
                        <time datetime="2017-02-02 00:00:00 &#43;0000 UTC" itemprop="datePublished">2017-02-02</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://www.luispedrofonseca.com/unite-los-angeles-16/" class="thumbnail">
                    
                        
                        <span style="background-image:url(http://www.luispedrofonseca.com/banners/unity-awards-16.png)" alt="Unity VR Joystick" class="thumbnail-image"></span>
                        
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-title"><a href="http://www.luispedrofonseca.com/unite-los-angeles-16/" class="title">Unite Los Angeles 16</a></p>
                    <p class="item-date">
                        <time datetime="2016-11-08 00:00:00 &#43;0000 UTC" itemprop="datePublished">2016-11-08</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://www.luispedrofonseca.com/unity-custom-rect-editor/" class="thumbnail">
                    
                        
                        <span style="background-image:url(http://www.luispedrofonseca.com/banners/unity-custom-rect-editor.png)" alt="Unity VR Joystick" class="thumbnail-image"></span>
                        
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-title"><a href="http://www.luispedrofonseca.com/unity-custom-rect-editor/" class="title">Unity Custom Rect Editor</a></p>
                    <p class="item-date">
                        <time datetime="2016-10-08 00:00:00 &#43;0000 UTC" itemprop="datePublished">2016-10-08</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://www.luispedrofonseca.com/new-site-engine-hugo/" class="thumbnail">
                    
                        
                        <span style="background-image:url(http://www.luispedrofonseca.com/banners/new-site-engine-hugo.jpg)" alt="Unity VR Joystick" class="thumbnail-image"></span>
                        
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-title"><a href="http://www.luispedrofonseca.com/new-site-engine-hugo/" class="title">New site engine — Hugo</a></p>
                    <p class="item-date">
                        <time datetime="2016-06-12 00:00:00 &#43;0000 UTC" itemprop="datePublished">2016-06-12</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://www.luispedrofonseca.com/procamera2d-at-gdc16/" class="thumbnail">
                    
                        
                        <span style="background-image:url(http://www.luispedrofonseca.com/banners/procamera2d-at-gdc16.jpg)" alt="Unity VR Joystick" class="thumbnail-image"></span>
                        
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-title"><a href="http://www.luispedrofonseca.com/procamera2d-at-gdc16/" class="title">ProCamera2D at GDC16</a></p>
                    <p class="item-date">
                        <time datetime="2016-04-10 00:00:00 &#43;0000 UTC" itemprop="datePublished">2016-04-10</time>
                    </p>
                </div>
            </li>
            
        </ul>
    </div>
</div>


    


<div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
        <ul class="category-list">
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.luispedrofonseca.com/categories/csharp">
                    csharp
                </a>
                <span class="category-list-count">6</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.luispedrofonseca.com/categories/plugins">
                    plugins
                </a>
                <span class="category-list-count">10</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.luispedrofonseca.com/categories/procamera2d">
                    procamera2d
                </a>
                <span class="category-list-count">5</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.luispedrofonseca.com/categories/project-cuba">
                    project-cuba
                </a>
                <span class="category-list-count">8</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.luispedrofonseca.com/categories/uncategorized">
                    uncategorized
                </a>
                <span class="category-list-count">3</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://www.luispedrofonseca.com/categories/unity">
                    unity
                </a>
                <span class="category-list-count">16</span>
            </li>
            
        </ul>
    </div>
</div>



    
    

    <div id="toTop" class="fa fa-chevron-up"></div>
</aside>

	    
	</div>
</div>

<footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017
      Luís Pedro Fonseca. All Rights Reserved. Website powered by <a href="//gohugo.io">Hugo</a>.
    </div>
  </div>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="http://www.luispedrofonseca.com/fancybox/jquery.fancybox.pack.js"></script>
<script src="http://www.luispedrofonseca.com/js/script.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<!-- MathJax -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</body>
</html>
